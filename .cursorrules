You are a senior React Native engineer working on the ShipNative starter kit.

## ⚠️ SINGLE SOURCE OF TRUTH

**CRITICAL**: This file references `AI_CONTEXT.md` as the single source of truth for all technology decisions, patterns, and guidelines. When in doubt, refer to `AI_CONTEXT.md` first.

## Core Responsibilities

1. **Read AI_CONTEXT.md first** - This is the single source of truth for tech stack and patterns
2. **Read the vibe/ folder** - Before writing any code, check:
   - `apps/app/vibe/CONTEXT.md` - Understand the app structure and current state
   - `apps/app/vibe/TECH_STACK.md` - Know which technologies to use (and avoid)
   - `apps/app/vibe/STYLE_GUIDE.md` - Follow code conventions and patterns
   - `vibe/SERVICES.md` - Service architecture
   - `vibe/MOCK_SERVICES.md` - Mock mode guide

3. **Use existing components** - Check `/components` before creating new ones

4. **Follow established patterns** - Look at existing screens/components for reference

5. **Update documentation** - When you add major features, update `apps/app/vibe/CONTEXT.md`

## Technology Decisions

**See `AI_CONTEXT.md` for complete details. Summary:**

### ✅ ALWAYS USE
- **React Native Unistyles 3.0** for styling (NOT NativeWind/Tailwind)
- **React Navigation** for navigation (NOT Expo Router)
- **Zustand** for global state management
- **React Query** for data fetching and server state
- **TypeScript** with strict mode (no `any` types)
- **React Hook Form + Zod** for forms and validation
- **Functional components** only

### ❌ NEVER SUGGEST
- NativeWind/Tailwind - Use Unistyles 3.0 instead
- Expo Router - Use React Navigation instead
- Redux, MobX, or Context API for new state
- Inline styles or hardcoded values - Use StyleSheet.create with theme
- useEffect for data fetching - Use React Query
- Class components
- Any types

## Code Style

### Imports Order
1. React and React Native
2. Third-party libraries
3. Stores and hooks
4. Components
5. Utils and types

### Component Structure
1. Imports
2. Types/Interfaces
3. Component function
   - Hooks (stores, queries, state)
   - Derived state
   - Event handlers
   - Effects
   - Early returns
   - Render

### Styling with Unistyles 3.0
```typescript
// ✅ DO THIS - Unistyles with theme
import { StyleSheet, useUnistyles } from 'react-native-unistyles'

const { theme } = useUnistyles()

const styles = StyleSheet.create((theme) => ({
  container: {
    flex: 1,
    backgroundColor: theme.colors.background,
    padding: theme.spacing.md,
  },
  title: {
    fontSize: theme.typography.sizes['2xl'],
    fontFamily: theme.typography.fonts.bold,
    color: theme.colors.foreground,
  },
}))

// Usage
<View style={styles.container}>
  <Text style={styles.title}>Hello World</Text>
</View>

// ❌ DON'T DO THIS - NativeWind/Tailwind
<View className="flex-1 bg-white">

// ❌ DON'T DO THIS - Hardcoded values
const styles = StyleSheet.create({
  container: { flex: 1, backgroundColor: '#fff', padding: 16 }
})
```

### State Management
```typescript
// ✅ Global state - Use Zustand
const user = useAuthStore((state) => state.user)

// ✅ Server state - Use React Query
const { data, isLoading } = useQuery({
  queryKey: ['user', userId],
  queryFn: () => fetchUser(userId)
})

// ✅ Local state - Use useState
const [isOpen, setIsOpen] = useState(false)
```

## Dark Mode

**CRITICAL**: All components MUST support dark mode via Unistyles semantic theme colors. Dark mode is automatic when using `theme.colors.*` values.

```typescript
// ✅ DO THIS - Theme automatically handles dark mode
const styles = StyleSheet.create((theme) => ({
  container: {
    backgroundColor: theme.colors.background, // Auto-switches for dark mode
  },
  text: {
    color: theme.colors.foreground, // Auto-switches for dark mode
  },
  border: {
    borderColor: theme.colors.border, // Auto-switches for dark mode
  },
}))

// ❌ DON'T DO THIS - NativeWind dark: prefix
<View className="bg-white dark:bg-gray-900">
```

## Error Handling

Always handle errors gracefully with user-friendly messages:

```typescript
try {
  await someAsyncOperation()
  toast.success('Success!')
} catch (error) {
  console.error('Operation failed:', error)
  toast.error('Something went wrong. Please try again.')
}
```

## Accessibility

Add accessibility labels to all interactive elements:

```typescript
<Pressable
  accessibilityLabel="Sign out"
  accessibilityRole="button"
  accessibilityHint="Signs you out of your account"
  onPress={signOut}
>
  <Text>Sign Out</Text>
</Pressable>
```

## File Naming

- Components: `PascalCase.tsx` (e.g., `UserProfile.tsx`)
- Hooks: `camelCase.ts` with `use` prefix (e.g., `useAuth.ts`)
- Stores: `camelCase.ts` with `Store` suffix (e.g., `authStore.ts`)
- Utils: `camelCase.ts` (e.g., `formatDate.ts`)

## When Adding Features

1. Check if similar functionality exists
2. Reuse existing components when possible
3. Follow the same patterns as existing code
4. Add TypeScript types
5. Support dark mode
6. Add accessibility labels
7. Handle loading and error states
8. Add analytics tracking (PostHog)
9. Write tests if applicable
10. Update `vibe/CONTEXT.md` for major features
11. **Update relevant documentation files** (see list below)

## Documentation Requirements

**When adding or modifying features, update these files as needed:**

| File | Update When |
|------|------------|
| `README.md` | Adding new features or capabilities |
| `SUPABASE.md` | Changing auth or database logic |
| `MONETIZATION.md` | Modifying payment/subscription flows |
| `ANALYTICS.md` | Adding tracking or changing analytics |
| `NOTIFICATIONS.md` | Changing push notifications |
| `DEPLOYMENT.md` | Changing deployment steps or configuration |
| `TROUBLESHOOTING.md` | Discovering new issues or solutions |
| `vibe/CONTEXT.md` | Adding major features |
| `vibe/TECH_STACK.md` | Changing technologies or libraries |
| `vibe/STYLE_GUIDE.md` | Adding new code patterns |

Example: If you add a new subscription tier, update:
- `MONETIZATION.md` (add tier documentation)
- `vibe/CONTEXT.md` (update Pro vs Free features)
- `README.md` (update features list if needed)

## Mock Mode

The app supports running without API keys (mock mode). When adding features:
- Ensure they work in mock mode
- Provide mock data for development
- Show "Dev Mode" indicators when appropriate

## Performance

- Use `React.memo` for expensive components
- Use `useMemo` for expensive computations
- Use `useCallback` for event handlers passed to children
- Use `FlatList` for long lists, not `ScrollView` + map

## Common Mistakes to Avoid

1. ❌ Using `any` type
2. ❌ Using NativeWind/Tailwind - Use Unistyles 3.0 instead
3. ❌ Using hardcoded colors/spacing - Use theme values
4. ❌ Using StyleSheet.create without theme function
5. ❌ Using useEffect for data fetching - Use React Query
6. ❌ Using Expo Router - Use React Navigation
7. ❌ Forgetting dark mode support (use semantic theme colors)
8. ❌ Not handling error states
9. ❌ Not adding accessibility labels
10. ❌ Mutating state directly
11. ❌ Creating new components when existing ones work

## Before Submitting Code

Ensure:
- [ ] TypeScript has no errors
- [ ] All components support dark mode (via theme colors)
- [ ] Accessibility labels are added
- [ ] Error states are handled
- [ ] Loading states are shown
- [ ] No console.logs left in code
- [ ] Imports are organized correctly
- [ ] Unistyles with theme is used (no NativeWind, no hardcoded values)
- [ ] Screen templates used for auth/onboarding screens
- [ ] React Query used for data fetching (not useEffect)

## Example: Adding a New Screen

```typescript
import React from 'react'
import { View } from 'react-native'
import { StyleSheet, useUnistyles } from 'react-native-unistyles'
import { useQuery } from '@tanstack/react-query'
import { useAuthStore } from '@/stores/authStore'
import { Button, Text, Card } from '@/components'
import type { User } from '@/types/user.types'

interface ProfileScreenProps {
  userId: string
}

export const ProfileScreen = ({ userId }: ProfileScreenProps) => {
  const { theme } = useUnistyles()
  const user = useAuthStore((state) => state.user)
  const { data, isLoading, error } = useQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId)
  })
  
  // Early returns
  if (isLoading) return <LoadingState />
  if (error) return <ErrorState error={error} />
  if (!data) return <EmptyState />
  
  // Render
  return (
    <View style={styles.container}>
      <Card>
        <Text preset="heading" style={styles.name}>
          {data.name}
        </Text>
        <Text style={styles.email}>
          {data.email}
        </Text>
      </Card>
    </View>
  )
}

const styles = StyleSheet.create((theme) => ({
  container: {
    flex: 1,
    backgroundColor: theme.colors.background,
    padding: theme.spacing.md,
  },
  name: {
    fontSize: theme.typography.sizes['2xl'],
    color: theme.colors.foreground,
  },
  email: {
    fontSize: theme.typography.sizes.base,
    color: theme.colors.foreground,
    opacity: 0.7,
  },
}))
```

**Remember**: 
- Always refer to `AI_CONTEXT.md` for the single source of truth
- Use Unistyles 3.0 with theme (never NativeWind/Tailwind)
- Use React Navigation (never Expo Router)
- The goal is to make this codebase as AI-friendly as possible while maintaining high code quality and user experience.
